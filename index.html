<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Cat√°logo TecnoFull DC</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>.hidden { display: none; }</style>
</head>
<body class="bg-white text-gray-900 font-sans">

<!-- NAV -->
<nav class="bg-black text-white fixed top-0 w-full z-50 shadow-md">
  <div class="bg-red-700 text-white p-1 text-center"></div>
  <div class="max-w-6xl mx-auto px-4 flex justify-between items-center py-3">
    <div class="flex-shrink-0 mr-6">
      <a href="#" class="text-white text-lg font-bold">TecnoFull DC</a>
    </div>
    <div class="hidden md:flex space-x-6 items-center">
      <a href="#" class="hover:bg-black px-3 py-2 rounded">Inicio</a>
      <a href="#" class="hover:bg-black px-3 py-2 rounded">Qui√©nes Somos</a>
      <a href="#" class="hover:bg-black px-3 py-2 rounded">Contacto</a>
    </div>
    <input id="searchInput" type="text" placeholder="Buscar productos..." 
           class="w-48 md:w-64 p-2 rounded border text-black">
  </div>
  <div class="bg-red-700 text-white p-1 text-center"></div>
</nav>

<!-- CAT√ÅLOGO -->
<main id="catalogo" 
      class="max-w-7xl mx-auto p-6 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 pt-24">
</main>

<script>
  const catalogo = document.getElementById("catalogo");
  const searchInput = document.getElementById("searchInput");
  let productosData = [];

  // Formateadores de moneda
  const formatUSD = new Intl.NumberFormat("en-US", { style: "currency", currency: "USD" });
  const formatARS = new Intl.NumberFormat("es-AR", { style: "currency", currency: "ARS" });

  function renderProductos(lista) {
    catalogo.innerHTML = "";
    lista.forEach(p => {
      const card = document.createElement("div");
      card.className = "producto bg-white rounded-2xl shadow-md p-4 flex flex-col";
      card.innerHTML = `
        <img src="${p.URL_IMAGEN}" alt="${p.PRODUCTO}" class="rounded-lg mb-3 mx-auto">
        <h2 class="text-lg font-bold text-red-800">${p.PRODUCTO}</h2>
        <p class="text-lg font-bold text-gray-800">${p.TIPO_PRODUCTO}</p>
        <span class="my-2 text-xs font-semibold bg-gray-200 text-gray-800 px-2 py-1 rounded self-start">
          ${p.MARCA}
        </span>
        <p class="text-gray-600 text-sm flex-grow">${p.DESCRIPCION}</p>
        <p class="text-green-700 font-semibold mt-2">${formatUSD.format(p.PRECIO_USD)}</p>
        <p class="text-blue-700 font-semibold">${formatARS.format(p.PRECIO_ARS)}</p>
        <a href="${p.URL_FICHA}" target="_blank"
           class="mt-3 inline-block text-center bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition">
          Ver Ficha T√©cnica
        </a>
      `;
      catalogo.appendChild(card);
    });
  }

  function buscarProductos() {
    const texto = searchInput.value.toLowerCase();
    const filtrados = productosData.filter(p =>
      (p.PRODUCTO && p.PRODUCTO.toLowerCase().includes(texto)) ||
      (p.MARCA && p.MARCA.toLowerCase().includes(texto)) ||
      (p.TIPO_PRODUCTO && p.TIPO_PRODUCTO.toLowerCase().includes(texto)) ||
      (p.DESCRIPCION && p.DESCRIPCION.toLowerCase().includes(texto))
    );
    renderProductos(filtrados);
  }
  searchInput.addEventListener("input", buscarProductos);

  // üîπ Cargar desde Google Sheets publicado
  async function cargarDatos() {
    const url = "https://docs.google.com/spreadsheets/d/TU_ID/gviz/tq?tqx=out:json&sheet=DatosCompletos";
    const res = await fetch(url);
    const text = await res.text();
    const json = JSON.parse(text.substr(47).slice(0, -2)); // Sheets devuelve texto envolviendo el JSON

    productosData = json.table.rows.map(r => ({
      PRODUCTO: r.c[0]?.v || "",
      MARCA: r.c[1]?.v || "",
      TIPO_PRODUCTO: r.c[2]?.v || "",
      DESCRIPCION: r.c[3]?.v || "",
      PRECIO_USD: r.c[4]?.v || 0,
      PRECIO_ARS: r.c[5]?.v || 0,
      URL_IMAGEN: r.c[6]?.v || "",
      URL_FICHA: r.c[7]?.v || ""
    }));

    renderProductos(productosData);
  }

  cargarDatos();
</script>
</body>
</html>
